(()=>{var v=Object.defineProperty;var w=(d,g)=>v(d,"name",{value:g,configurable:!0});var K;if(!(!((K=keyman==null?void 0:keyman.ui)===null||K===void 0)&&K.name))try{let d=keyman,g=d.util;if(g.isTouchDevice())throw"";let y=class y{constructor(){this.init=!1,this.toolbarNode=null,this.browseMapNode=null,this.keyboardsButtonNode=null,this.languageButtonsNode=null,this.offButtonNode=null,this.offBarNode=null,this.oskButtonNode=null,this.oskBarNode=null,this.selectorNode=null,this.regionLanguageListNodes={},this.regionsNode=null,this.regionNodes=null,this.langKeyboardNodes={},this.langKeyboardListNodes={},this.selectedRegion="as",this.listedKeyboards=[],this.catchAllRegion="un",this.keyboardListPriority=0,this.maxListedKeyboards=1,this.lastActiveControl=null,this.selectedKeyboard=null,this.selectedLanguage="",this.helpOffsetX=0,this.helpOffsetY=0,this.keyboardsForLangPopup=null,this.lastSelectedKeyboard=null,this.languages={},this.updateMap=!1,this.startTimer=0,this.lgText="",this.name="toolbar",this.ToolBar_Text={Keyboards:"Languages",OffTitle:"Turn off KeymanWeb keyboards",Off:"Off",ShowOSK:"Show On Screen Keyboard",LanguageSelector:"Select language",SelectKeyboardPre:"Select ",SelectKeyboardSuf:"keyboard",AltKeyboardsPre:"Alternate keyboards for ",AltKeyboardsSuf:"",ca:"Central America",sa:"South America",na:"Americas",eu:"Europe",af:"Africa",un:"Undetermined",as:"Asia",oc:"Oceania"},this.addKeyboardsToMap=()=>{if(this.updateMap)this.updateMap=!1;else return;this.regionLanguageListNodes={};let e=d.getKeyboards();e.sort(this.sortKeyboards);let t=0;for(t=this.regionsNode.children.length;t>0;t--)this.regionsNode.children[t-1].className=="kmw_selector_region"&&this.regionsNode.removeChild(this.regionsNode.childNodes[t-1]);for(let l in this.regions){this.regionLanguageListNodes[l]=this.createNode("div",null,"kmw_selector_region");let u=this.createNode("div",null,"kmw_keyboard_col");var s=0,a=0,i="";for(let r=0;r<e.length;r++){var o=e[r].RegionCode;if(this.regions[o]){if(o!=l)continue}else if(l!=this.catchAllRegion)continue;var n=d.util.getLanguageCodes(e[r].LanguageCode);n[0]!=i&&(i=n[0],s++)}s=Number(((s+3)/4).toFixed(0)),i="";for(let r=0;r<e.length;r++){let h=e[r].RegionCode;if(this.regions[h]){if(h!=l)continue}else if(l!=this.catchAllRegion)continue;var n=d.util.getLanguageCodes(e[r].LanguageCode);if(n[0]==i){var b=this.languages[i].keyboards;b.push?b.push(e[r]):this.languages[i].keyboards=b.concat(e[r]);continue}i=n[0],this.languages[i]={id:e[r].LanguageCode,name:e[r].LanguageName,keyboards:[e[r]]},a%s==0&&a>0&&(this.regionLanguageListNodes[l].appendChild(u),u=this.createNode("div",null,a/s==3?"kmw_keyboard_col_right":"kmw_keyboard_col")),a++;let c=this.createNode("div",null,"kmw_language"),f=this.createNode("a",null,null,e[r].LanguageName);f.href="#",f.onclick=(k=>_=>this.selectLanguage(_,k))(this.languages[i]),c.appendChild(f),u.appendChild(c),t++}this.regionLanguageListNodes[l].appendChild(u),this.regionLanguageListNodes[l].appendChild(this.createNode("div",null,"kmw_clear")),this.regionsNode.appendChild(this.regionLanguageListNodes[l])}this.loadCookie(),this.selectRegion(null,this.selectedRegion),this.enableControls(),this.lastSelectedKeyboard&&this.changeKeyboardEvent(this.lastSelectedKeyboard),d.focusLastActiveElement()},this.sortKeyboards=function(e,t){return e.RegionCode<t.RegionCode?-2:e.RegionCode>t.RegionCode?2:e.LanguageName<t.LanguageName?-1:e.LanguageName>t.LanguageName?1:0},this.registerKeyboard=()=>{this.updateMap=!0,this.startTimer&&clearTimeout(this.startTimer),this.startTimer=window.setTimeout(this.addKeyboardsToMap,0)},this.hideKeyboardsForLanguage=e=>{var t=this.keyboardsForLangPopup;return t&&(t.style.display="none"),this.CancelPopupDismissal(this.hideKeyboardsForLanguage),this.eventCapture(e)},this.showKeyboardsForLanguage=(e,t)=>{this.hideKeyboardsPopup(e);let s=this.langKeyboardListNodes[t.id];if(s){if(s.style.display=="block")return this.hideKeyboardsForLanguage(e);s.style.display="block",this.keyboardsForLangPopup=s,this.SetupPopupDismissal(s,this.hideKeyboardsForLanguage)}return this.eventCapture(e)},this.showOSK=e=>{let t=d.osk;return t?(d.activatingUI(!0),t&&d.getActiveKeyboard()!=""&&(t.isEnabled()?t.hide():t.show(!0)),this.setLastFocus(),d.activatingUI(!1),this.eventCapture(e)):!1},this.offButtonClickEvent=e=>{if(this.toolbarNode.className!="kmw_controls_disabled"){if(this.hideKeyboardsForLanguage(null),this.selectedLanguage){var t=this.findListedKeyboard(this.selectedLanguage);t!=null&&(this.listedKeyboards[t].buttonNode.className="kmw_button")}this.selectedKeyboard=null,this.selectedLanguage=null,this.offButtonNode.className="kmw_button_selected"}return this.setLastFocus(),d.setActiveKeyboard("",""),this.saveCookie(),this.enableControls(),this.eventCapture(e)},this.eventCapture=e=>(e||(e=window.event),window.event&&(window.event.returnValue=!1),e&&(e.cancelBubble=!0),!1),this.selectRegion=(e,t)=>{let s=this.browseMapNode;return s?(s.className="kmw_browsemap_"+t,typeof this.regionLanguageListNodes[t]=="undefined"&&(this.updateMap=!0,this.addKeyboardsToMap()),this.regionLanguageListNodes[t].style.display="block",this.regionNodes[t].className="selected",this.selectedRegion!=null&&this.selectedRegion!=t&&(this.regionLanguageListNodes[this.selectedRegion].style.display="none",this.regionNodes[this.selectedRegion].className=""),this.selectedRegion=t,this.eventCapture(e)):this.eventCapture(e)},this.unhoverRegion=(e,t)=>(this.browseMapNode.className=this.selectedRegion==null?"":"kmw_browsemap_"+this.selectedRegion,this.regionNodes[t].className=this.selectedRegion==t?"selected":"",this.eventCapture(e)),this.hoverRegion=(e,t)=>(this.browseMapNode.className="kmw_browsemap_"+t+"_sel",this.regionNodes[t].className="hover",this.eventCapture(e)),this.focusControlEvent=e=>{if(!this.init)return!0;let t=e.target;if(t.tagName.toLowerCase()=="textarea"||t.tagName.toLowerCase()=="input"&&t.type.toLowerCase()=="text")if(this.lastActiveControl=t,this.pluck(t,"kmw_disable"))this.toolbarNode.className!="kmw_controls_disabled"&&(this.toolbarNode.className="kmw_controls_disabled");else{if(this.selectedKeyboard!=null)if(d.isCJK())this.oskButtonNode.style.display=this.oskBarNode.style.display="none";else{let i=d.osk;this.oskButtonNode.className=i&&i.isEnabled()?"kmw_button_selected":"kmw_button"}this.toolbarNode.className!=""&&(this.toolbarNode.className="");let s,a;t.KMW_HelpOffsetX?s=t.KMW_HelpOffsetX:s=64,t.KMW_HelpOffsetY?a=t.KMW_HelpOffsetY:a=0,this.helpOffsetX=g.getAbsoluteX(t)+s,this.helpOffsetY=g.getAbsoluteY(t)+t.offsetHeight+a}return!0},this.blurControlEvent=()=>(this.init&&this.oskButtonNode.style.display!="none"&&(this.oskButtonNode.className="kmw_button_disabled"),!0),this.changeKeyboardEvent=e=>{this.lastSelectedKeyboard=null;let t=e.internalName,s=d.util.getLanguageCodes(e.languageCode)[0];if(s!=""&&t!=""){let a=this.languages[s];if(a!=null){for(let i=0;i<a.keyboards.length;i++)if(a.keyboards[i].InternalName==t)return this.selectKeyboard(null,a,a.keyboards[i],!1),!0}this.lastSelectedKeyboard=Object.assign({},e)}return!0},this.onShowOSK=e=>(this.init&&(this.oskButtonNode.className="kmw_button_selected"),e),this.onHideOSK=e=>{this.init&&e.HiddenByUser&&(this.oskButtonNode.className="kmw_button")},this.showKeyboardsPopup=e=>(this.addKeyboardsToMap(),this.toolbarNode.className=="kmw_controls_disabled"?this.eventCapture(e):(this.hideKeyboardsForLanguage(null),this.selectorNode.className=="kmw_over"?this.hideKeyboardsPopup(e):(this.selectorNode.className="kmw_over",this.keyboardsButtonNode.className="kmw_button_selected",this.SetupPopupDismissal(this.selectorNode,this.hideKeyboardsPopup),this.eventCapture(e)))),this.hideKeyboardsPopup=e=>(this.selectorNode.className="",this.keyboardsButtonNode.className="kmw_button",this.CancelPopupDismissal(this.hideKeyboardsPopup),this.eventCapture(e)),this.hideAllPopups=e=>{var t=this.keyboardsForLangPopup;return(!t||t.style.display=="none")&&this.selectorNode.className==""?!0:(this.hideKeyboardsPopup(e),this.hideKeyboardsForLanguage(e),this.eventCapture(e))},this.dismissalCallback=null,this.popupElement=null,this.lastDismissalCallback=null,this.PopupDismissal=e=>{let t=e&&e.target||window.event&&window.event.srcElement;if(t)for(;t.parentElement;){if(t==this.popupElement)return null;t=t.parentElement}return t.nodeName=="#document"&&this.hideAllPopups(e),this.dismissalCallback}}createNode(e,t,s,a){let i=document.createElement(e);return t&&(i.id=t),s&&(i.className=s),a&&(i.innerHTML=a),(e=="a"||e=="area"||e=="map")&&(i.ondragstart=()=>!1),i}initialize(){if(!d.initialized||this.init)return;let e=document.getElementById("KeymanWebControl");if(!e){if(document.body==null)return;e=document.createElement("div"),e.id="KeymanWebControl",document.body.insertBefore(e,document.body.firstChild),this._insertedElem=e}if(e.style.visibility="hidden",e.style.maxHeight="35px",this.init=!0,g.isTouchDevice())return;this.regions={},this.regions.na={t:this.ToolBar_Text.na,m:"0,3,0,37,24,32,35,37,43,47,49,52,65,54,68,57,71,56,73,59,75,60,93,61,93,57,103,49,118,41,126,41,136,23,148,17,156,14,164,5,164,0,57,0,35,5,25,9,5,8,49,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61,82,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89"},this.regions.eu={t:this.ToolBar_Text.eu,m:"145,29,146,19,158,14,171,6,187,2,206,1,217,4,227,11,231,16,231,33,227,34,225,35,225,37,227,39,228,44,228,47,227,48,223,46,218,44,215,43,208,43,203,45,202,48,205,52,201,52,195,49,189,50,187,48,177,48,175,49,166,50,147,33"},this.regions.af={t:this.ToolBar_Text.af,m:"150,58,158,50,166,50,175,49,177,48,187,48,189,50,195,49,201,52,205,52,207,53,221,75,229,75,231,77,231,85,227,92,232,101,237,106,237,112,227,115,222,118,206,125,199,127,193,127,185,111,183,104,180,87,168,89,153,85,143,71,147,60"},this.regions.as={t:this.ToolBar_Text.as,m:"219,1,221,6,228,12,231,16,231,33,227,34,225,35,225,37,227,39,229,45,232,48,239,48,240,49,239,53,242,60,243,65,249,70,252,81,259,87,271,87,278,95,289,100,303,101,311,98,320,98,323,98,323,84,311,81,308,73,307,65,317,57,330,50,334,44,348,36,364,38,375,34,375,8,355,8,336,5,292,1,285,0,219,0"},this.regions.oc={t:this.ToolBar_Text.oc,m:"288,117,289,107,303,101,311,98,323,98,323,84,333,77,344,73,362,80,369,88,375,96,375,141,352,143,323,142,316,136,310,130,291,130"},this.regions.un={t:this.ToolBar_Text.un,m:"205,52,202,48,203,45,208,43,215,43,218,44,223,46,227,48,232,48,239,48,240,49,239,53,242,60,243,65,237,76,231,77,229,75,221,75,207,53"},this.toolbarNode=this.createNode("div","kmw_controls"),this.toolbarNode.style.display="block",g.linkStyleSheet(g.getOption("resources")+"ui/toolbar/kmwuitoolbar.css");let t=this.createNode("a","kmw_controls_start",null," ");t.href="https://keyman.com/developer/keymanweb/",t.target="_blank",this.toolbarNode.appendChild(t),this.keyboardsButtonNode=this.createNode("div","kmw_btn_keyboards","kmw_button"),this.keyboardsButtonNode.title=this.ToolBar_Text.LanguageSelector;let s=this.createNode("a",null,"kmw_button_a");s.href="#",s.onclick=this.showKeyboardsPopup,s.appendChild(this.createNode("div","kmw_img_keyboards","kmw_img")),s.appendChild(this.createNode("div",null,"kmw_a",this.ToolBar_Text.Keyboards)),s.appendChild(this.createNode("div",null,"kmw_drop")),this.keyboardsButtonNode.appendChild(s),this.selectorNode=this.createNode("div","kmw_selector"),this.regionsNode=this.createNode("div","kmw_selector_regions"),this.browseMapNode=this.createNode("div","kmw_browsemap");let a=this.createNode("img","kmw_region_browsemap");a.src=g.getOption("resources")+"ui/toolbar/blank.gif",a.useMap="#kmw_worldgrey16",this.browseMapNode.appendChild(a);let i=this.createNode("map","kmw_worldgrey16");i.name="kmw_worldgrey16";for(let l in this.regions){let u=this.createNode("area");u.shape="poly",u.alt="",u.href="#",u.title=this.regions[l].t,u.hidefocus="true",u.onclick=(r=>h=>this.selectRegion(h,r))(l),u.onmouseover=(r=>h=>this.hoverRegion(h,r))(l),u.onmouseout=(r=>h=>this.unhoverRegion(h,r))(l),u.coords=this.regions[l].m,i.appendChild(u)}let o=this.createNode("area");o.shape="default",o.noHref=!0,o.alt="",o.onclick=this.eventCapture,i.appendChild(o),this.browseMapNode.appendChild(i),this.regionsNode.appendChild(this.browseMapNode),this.regionNodes={};let n=this.createNode("ul");for(let l in this.regions){let u=this.createNode("li");this.regionNodes[l]=this.createNode("a",null,null,this.regions[l].t),this.regionNodes[l].href="#",this.regionNodes[l].onclick=(r=>h=>this.selectRegion(h,r))(l),this.regionNodes[l].onmouseover=(r=>h=>this.hoverRegion(h,r))(l),this.regionNodes[l].onmouseout=(r=>h=>this.unhoverRegion(h,r))(l),u.appendChild(this.regionNodes[l]),n.appendChild(u)}this.regionsNode.appendChild(n),this.selectorNode.appendChild(this.regionsNode),this.keyboardsButtonNode.appendChild(this.selectorNode),this.toolbarNode.appendChild(this.keyboardsButtonNode),this.toolbarNode.appendChild(this.offBarNode=this.createNode("div","kmw_bar_off","kmw_bar")),this.offButtonNode=this.createNode("div","kmw_btn_off","kmw_button_selected"),s=this.createNode("a",null,"kmw_button_a"),s.href="#",s.onclick=this.offButtonClickEvent,s.title=this.ToolBar_Text.OffTitle,s.appendChild(this.createNode("div","kmw_img_off","kmw_img")),s.appendChild(this.createNode("div",null,"kmw_a",this.ToolBar_Text.Off)),this.offButtonNode.appendChild(s),this.toolbarNode.appendChild(this.offButtonNode),this.toolbarNode.appendChild(this.languageButtonsNode=this.createNode("div","kmw_control_keyboards","kmw_button")),this.toolbarNode.appendChild(this.oskBarNode=this.createNode("div","kmw_bar_osk","kmw_bar")),this.oskButtonNode=this.createNode("div","kmw_btn_osk","kmw_button"),s=this.createNode("a",null,"kmw_button_a"),s.href="#",s.onclick=this.showOSK,s.onmousedown=function(){d.activatingUI(!0)},s.title=this.ToolBar_Text.ShowOSK,s.appendChild(this.createNode("div","kmw_img_osk","kmw_img")),this.oskButtonNode.appendChild(s),this.toolbarNode.appendChild(this.oskButtonNode),this.toolbarNode.appendChild(this.createNode("div","kmw_controls_end",null," "));let b=this.createNode("div");b.id="kmw_map_preload",this.toolbarNode.appendChild(b),this.toolbarNode.appendChild(this.createNode("br",null,"kmw_clear")),e.appendChild(this.toolbarNode),this.updateMap=!0,this.startTimer&&clearTimeout(this.startTimer),this.startTimer=window.setTimeout(this.addKeyboardsToMap,0),g.attachDOMEvent(document.body,"click",this.hideAllPopups,!1),this.selectedRegion="eu",this.registerEvents(),d.focusLastActiveElement()}shutdown(){let e=this.toolbarNode;e&&e.parentNode.removeChild(e),e=this._insertedElem,e&&e.parentNode.removeChild(e)}findListedKeyboard(e){typeof e!="string"&&(e=e.id);for(let t=0;t<this.listedKeyboards.length;t++)if(this.listedKeyboards[t].lang.id==e)return t;return null}addKeyboardToList(e,t){let s=this.findListedKeyboard(e);if(s==null){if(this.listedKeyboards.length>=this.maxListedKeyboards){let h=2147483647,p=null;for(let c=0;c<this.listedKeyboards.length;c++)this.listedKeyboards[c].priority<h&&(p=c,h=this.listedKeyboards[c].priority);if(p!=null){let c=this.listedKeyboards[p];this.langKeyboardListNodes[c.lang.id]=null,this.langKeyboardNodes[c.lang.id]=null,this.languageButtonsNode.removeChild(c.buttonNode),p==0?this.listedKeyboards=this.listedKeyboards.slice(p+1):p==this.listedKeyboards.length-1?this.listedKeyboards=this.listedKeyboards.slice(0,p):this.listedKeyboards=this.listedKeyboards.slice(0,p).concat(this.listedKeyboards.slice(p+1))}}let i=this.createNode("div",null,"kmw_button"),o=this.createNode("a",null,"kmw_button_a"+(e.keyboards.length>1?" kmw_norightgap":""));o.href="#";let n=this.ToolBar_Text.SelectKeyboardPre+t.Name,b=this.ToolBar_Text.SelectKeyboardSuf;n.toLowerCase().indexOf(b.toLowerCase())<0&&(n=n+" "+b),o.title=n,o.onclick=h=>this.selectLanguage(h,e),o.appendChild(this.createNode("div","kmw_img_kbd","kmw_img")),this.lgText=this.truncate(e.name,28),o.appendChild(this.createNode("div",null,"kmw_a",this.lgText)),i.appendChild(o);let l=o;if(e.keyboards.length>1){o=this.createNode("a",null,"kmw_button_a kmw_noleftgap"),o.href="#",o.title=this.ToolBar_Text.AltKeyboardsPre+e.name+this.ToolBar_Text.AltKeyboardsSuf,o.onclick=c=>this.showKeyboardsForLanguage(c,e);let h=this.createNode("div",null,"kmw_a"),p=this.truncate(t.Name.replace(/\s?keyboard/i,""),40-this.lgText.length);h.appendChild(this.langKeyboardNodes[e.id]=this.createNode("span",null,"kmw_kbd",p)),o.appendChild(h),o.appendChild(this.createNode("div",null,"kmw_drop")),i.appendChild(o),this.langKeyboardListNodes[e.id]=this.createNode("ul",null,"kmw_selector_kbd"),this.langKeyboardListNodes[e.id].style.display="none";for(let c in e.keyboards){let f=this.createNode("li");p=e.keyboards[c].Name.replace(/\s?keyboard/i,""),p=p+" ["+e.keyboards[c].LanguageCode+"]",o=this.createNode("a",null,null,p),o.href="#",o.title="",o.onclick=((k,_)=>C=>this.selectKeyboard(C,k,_,!0))(e,e.keyboards[c]),f.appendChild(o),this.langKeyboardListNodes[e.id].appendChild(f)}i.appendChild(this.langKeyboardListNodes[e.id])}this.languageButtonsNode.appendChild(i);let u=e,r=i;this.listedKeyboards.push({priority:this.keyboardListPriority++,lang:u,keyboard:t,buttonNode:r,aNode:l})}else{this.listedKeyboards[s].priority=this.keyboardListPriority++,this.listedKeyboards[s].keyboard=t;let i=this.langKeyboardNodes[e.id];if(i){var a=t.Name.replace(/\s?keyboard/i,"");i.innerHTML=this.truncate(a,40-this.lgText.length)}if(this.listedKeyboards[s].aNode){let o=this.ToolBar_Text.SelectKeyboardPre+t.Name,n=this.ToolBar_Text.SelectKeyboardSuf;o.toLowerCase().indexOf(n.toLowerCase())<0&&(o=o+" "+n),this.listedKeyboards[s].aNode.title=o}}}truncate(e,t){return e.length<=t?e:e.substr(0,t-1)+"\u2026"}selectLanguage(e,t){let s=this.findListedKeyboard(t),a=null;return s==null?a=t.keyboards[0]:a=this.listedKeyboards[s].keyboard,a?this.selectKeyboard(e,t,a,!0):!1}selectKeyboard(e,t,s,a){if(d.activatingUI(!0),this.selectedLanguage){let i=this.findListedKeyboard(this.selectedLanguage);i!=null&&(this.listedKeyboards[i].buttonNode.className="kmw_button")}return this.offButtonNode.className="kmw_button",this.selectedKeyboard=s,this.selectedLanguage=s.LanguageCode,this.addKeyboardToList(t,s),a&&d.setActiveKeyboard(s.InternalName,s.LanguageCode).then(()=>{this.setLastFocus()}),this.listedKeyboards[this.findListedKeyboard(t)].buttonNode.className="kmw_button_selected",this.saveCookie(),this.enableControls(),d.activatingUI(!1),this.hideKeyboardsPopup(e)||this.hideKeyboardsForLanguage(e)}enableControls(){let e=[this.offButtonNode,this.offBarNode,this.oskButtonNode,this.oskBarNode],t=!1;if(d.isCJK(this.selectedKeyboard)?t=!0:this.selectedKeyboard==null&&(t=e[2].style.display=="none"),this.selectedKeyboard!=null||this.listedKeyboards.length>0)for(let s=0;s<e.length;s++)e[s].style.display="";else for(let s=0;s<e.length;s++)e[s].style.display="none";return t?this.oskButtonNode.style.display=this.oskBarNode.style.display="none":this.selectedKeyboard==null&&(this.oskButtonNode.className="kmw_button_disabled"),this.toolbarNode.parentElement.style.visibility="visible",!0}setLastFocus(){d.focusLastActiveElement()}pluck(e,t){return e.getAttribute&&e.getAttribute(t)||e[t]}registerEvents(){let e=d.osk;e&&(e.addEventListener("show",this.onShowOSK),e.addEventListener("hide",this.onHideOSK))}SetupPopupDismissal(e,t){this.PopupDismissal==document.onclick&&this.CancelPopupDismissal(this.dismissalCallback),this.dismissalCallback=t,this.popupElement=e,this.lastDismissalCallback=document.onclick,document.onclick=this.PopupDismissal}CancelPopupDismissal(e){this.PopupDismissal==document.onclick&&(document.onclick=this.lastDismissalCallback,this.lastDismissalCallback=null,this.dismissalCallback=null,this.popupElement=null)}loadCookie(){let e="",t=g.loadCookie("KeymanWeb_Keyboard");t.current!=null&&(e=t.current.split(":")[0]);let s=g.loadCookie("KeymanWeb_Toolbar");if(s.region!=null&&(this.selectedRegion=s.region),s.maxrecent!=null){for(let b=0;b<s.maxrecent;b++)if(s[`recent${b}`]!=null){var a=s[`recent${b}`].split(",");if(a.length==2){var i=this.languages[a[0]];if(i!=null){for(var o=0;o<i.keyboards.length;o++)if(i.keyboards[o].InternalName==a[1]){if(this.addKeyboardToList(i,i.keyboards[o]),i.keyboards[o].InternalName==e){this.selectKeyboard(null,i,i.keyboards[o],!0),window.focus(),this.setLastFocus();break}break}}}}}else{let b=d.getActiveKeyboard(),l=d.getActiveLanguage();if(l!=""&&b!=""){var n=this.languages[l];if(n!=null)for(var o=0;o<n.keyboards.length;o++)n.keyboards[o].InternalName==b&&(this.selectKeyboard(null,n,n.keyboards[o],!0),window.focus(),this.setLastFocus())}}}saveCookie(){let e={region:this.selectedRegion,maxrecent:this.listedKeyboards.length};e.region=this.selectedRegion,e.maxrecent=this.listedKeyboards.length;for(var t=0;t<this.listedKeyboards.length;t++)e[`recent${t}`]=this.listedKeyboards[t].lang.id+","+this.listedKeyboards[t].keyboard.InternalName;g.saveCookie("KeymanWeb_Toolbar",e)}};w(y,"ToolbarUI");let N=y,m=d.ui=new N;d.addEventListener("keyboardregistered",m.registerKeyboard),d.addEventListener("controlfocused",m.focusControlEvent),d.addEventListener("controlblurred",m.blurControlEvent),d.addEventListener("keyboardchange",m.changeKeyboardEvent),m.initialize()}catch(d){}})();
//# sourceMappingURL=kmwuitoolbar.js.map
