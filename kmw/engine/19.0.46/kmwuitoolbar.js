(()=>{var C=Object.defineProperty;var k=(g,p)=>C(g,"name",{value:p,configurable:!0});var y,n=window.keyman;if(n){if(!(!((y=n.ui)===null||y===void 0)&&y.name))try{let g=n.util;if(g.isTouchDevice())throw"";let N=class N{constructor(){this.init=!1,this.toolbarNode=null,this.browseMapNode=null,this.keyboardsButtonNode=null,this.languageButtonsNode=null,this.offButtonNode=null,this.offBarNode=null,this.oskButtonNode=null,this.oskBarNode=null,this.selectorNode=null,this.regionLanguageListNodes={},this.regionsNode=null,this.regionNodes=null,this.langKeyboardNodes={},this.langKeyboardListNodes={},this.selectedRegion="as",this.listedKeyboards=[],this.catchAllRegion="un",this.keyboardListPriority=0,this.maxListedKeyboards=1,this.lastActiveControl=null,this.selectedKeyboard=null,this.selectedLanguage="",this.helpOffsetX=0,this.helpOffsetY=0,this.keyboardsForLangPopup=null,this.lastSelectedKeyboard=null,this.languages={},this.updateMap=!1,this.startTimer=0,this.lgText="",this.name="toolbar",this.ToolBar_Text={Keyboards:"Languages",OffTitle:"Turn off KeymanWeb keyboards",Off:"Off",ShowOSK:"Show On Screen Keyboard",LanguageSelector:"Select language",SelectKeyboardPre:"Select ",SelectKeyboardSuf:"keyboard",AltKeyboardsPre:"Alternate keyboards for ",AltKeyboardsSuf:"",ca:"Central America",sa:"South America",na:"Americas",eu:"Europe",af:"Africa",un:"Undetermined",as:"Asia",oc:"Oceania"},this.addKeyboardsToMap=()=>{if(this.updateMap)this.updateMap=!1;else return;this.regionLanguageListNodes={};let e=n.getKeyboards();e.sort(this.sortKeyboards);let t=0;for(t=this.regionsNode.children.length;t>0;t--)this.regionsNode.children[t-1].className=="kmw_selector_region"&&this.regionsNode.removeChild(this.regionsNode.childNodes[t-1]);for(let s in this.regions){this.regionLanguageListNodes[s]=this.createNode("div",null,"kmw_selector_region");let o=this.createNode("div",null,"kmw_keyboard_col"),i=0,a=0,l="";for(let b=0;b<e.length;b++){let r=e[b].RegionCode;if(this.regions[r]){if(r!=s)continue}else if(s!=this.catchAllRegion)continue;let u=n.util.getLanguageCodes(e[b].LanguageCode);u[0]!=l&&(l=u[0],i++)}i=Number(((i+3)/4).toFixed(0)),l="";for(let b=0;b<e.length;b++){let r=e[b].RegionCode;if(this.regions[r]){if(r!=s)continue}else if(s!=this.catchAllRegion)continue;let u=n.util.getLanguageCodes(e[b].LanguageCode);if(u[0]==l){let c=this.languages[l].keyboards;c.push?c.push(e[b]):this.languages[l].keyboards=c.concat(e[b]);continue}l=u[0],this.languages[l]={id:e[b].LanguageCode,name:e[b].LanguageName,keyboards:[e[b]]},a%i==0&&a>0&&(this.regionLanguageListNodes[s].appendChild(o),o=this.createNode("div",null,a/i==3?"kmw_keyboard_col_right":"kmw_keyboard_col")),a++;let h=this.createNode("div",null,"kmw_language"),d=this.createNode("a",null,null,e[b].LanguageName);d.href="#",d.onclick=(c=>m=>this.selectLanguage(m,c))(this.languages[l]),h.appendChild(d),o.appendChild(h),t++}this.regionLanguageListNodes[s].appendChild(o),this.regionLanguageListNodes[s].appendChild(this.createNode("div",null,"kmw_clear")),this.regionsNode.appendChild(this.regionLanguageListNodes[s])}this.loadCookie(),this.selectRegion(null,this.selectedRegion),this.enableControls(),this.lastSelectedKeyboard&&this.changeKeyboardEvent(this.lastSelectedKeyboard),n.focusLastActiveElement()},this.sortKeyboards=function(e,t){return e.RegionCode<t.RegionCode?-2:e.RegionCode>t.RegionCode?2:e.LanguageName<t.LanguageName?-1:e.LanguageName>t.LanguageName?1:0},this.registerKeyboard=()=>{this.updateMap=!0,this.startTimer&&clearTimeout(this.startTimer),this.startTimer=window.setTimeout(this.addKeyboardsToMap,0)},this.hideKeyboardsForLanguage=e=>{let t=this.keyboardsForLangPopup;return t&&(t.style.display="none"),this.CancelPopupDismissal(this.hideKeyboardsForLanguage),this.eventCapture(e)},this.showKeyboardsForLanguage=(e,t)=>{this.hideKeyboardsPopup(e);let s=this.langKeyboardListNodes[t.id];if(s){if(s.style.display=="block")return this.hideKeyboardsForLanguage(e);s.style.display="block",this.keyboardsForLangPopup=s,this.SetupPopupDismissal(s,this.hideKeyboardsForLanguage)}return this.eventCapture(e)},this.showOSK=e=>{let t=n.osk;return t?(n.activatingUI(!0),t&&n.getActiveKeyboard()!=""&&(t.isEnabled()?t.hide():t.show(!0)),this.setLastFocus(),n.activatingUI(!1),this.eventCapture(e)):!1},this.offButtonClickEvent=e=>{if(this.toolbarNode.className!="kmw_controls_disabled"){if(this.hideKeyboardsForLanguage(null),this.selectedLanguage){let t=this.findListedKeyboard(this.selectedLanguage);t!=null&&(this.listedKeyboards[t].buttonNode.className="kmw_button")}this.selectedKeyboard=null,this.selectedLanguage=null,this.offButtonNode.className="kmw_button_selected"}return this.setLastFocus(),n.setActiveKeyboard("",""),this.saveCookie(),this.enableControls(),this.eventCapture(e)},this.eventCapture=e=>(e||(e=window.event),window.event&&(window.event.returnValue=!1),e&&(e.cancelBubble=!0),!1),this.selectRegion=(e,t)=>{let s=this.browseMapNode;return s?(s.className="kmw_browsemap_"+t,typeof this.regionLanguageListNodes[t]=="undefined"&&(this.updateMap=!0,this.addKeyboardsToMap()),this.regionLanguageListNodes[t].style.display="block",this.regionNodes[t].className="selected",this.selectedRegion!=null&&this.selectedRegion!=t&&(this.regionLanguageListNodes[this.selectedRegion].style.display="none",this.regionNodes[this.selectedRegion].className=""),this.selectedRegion=t,this.eventCapture(e)):this.eventCapture(e)},this.unhoverRegion=(e,t)=>(this.browseMapNode.className=this.selectedRegion==null?"":"kmw_browsemap_"+this.selectedRegion,this.regionNodes[t].className=this.selectedRegion==t?"selected":"",this.eventCapture(e)),this.hoverRegion=(e,t)=>(this.browseMapNode.className="kmw_browsemap_"+t+"_sel",this.regionNodes[t].className="hover",this.eventCapture(e)),this.focusControlEvent=e=>{if(!this.init)return!0;let t=e.target;if(t.tagName.toLowerCase()=="textarea"||t.tagName.toLowerCase()=="input"&&t.type.toLowerCase()=="text")if(this.lastActiveControl=t,this.pluck(t,"kmw_disable"))this.toolbarNode.className!="kmw_controls_disabled"&&(this.toolbarNode.className="kmw_controls_disabled");else{if(this.selectedKeyboard!=null)if(n.isCJK())this.oskButtonNode.style.display=this.oskBarNode.style.display="none";else{let i=n.osk;this.oskButtonNode.className=i&&i.isEnabled()?"kmw_button_selected":"kmw_button"}this.toolbarNode.className!=""&&(this.toolbarNode.className="");let s,o;t.KMW_HelpOffsetX?s=t.KMW_HelpOffsetX:s=64,t.KMW_HelpOffsetY?o=t.KMW_HelpOffsetY:o=0,this.helpOffsetX=g.getAbsoluteX(t)+s,this.helpOffsetY=g.getAbsoluteY(t)+t.offsetHeight+o}return!0},this.blurControlEvent=()=>(this.init&&this.oskButtonNode.style.display!="none"&&(this.oskButtonNode.className="kmw_button_disabled"),!0),this.changeKeyboardEvent=e=>{this.lastSelectedKeyboard=null;let t=e.internalName,s=n.util.getLanguageCodes(e.languageCode)[0];if(s!=""&&t!=""){let o=this.languages[s];if(o!=null){for(let i=0;i<o.keyboards.length;i++)if(o.keyboards[i].InternalName==t)return this.selectKeyboard(null,o,o.keyboards[i],!1),!0}this.lastSelectedKeyboard=Object.assign({},e)}return!0},this.onShowOSK=e=>(this.init&&(this.oskButtonNode.className="kmw_button_selected"),e),this.onHideOSK=e=>{this.init&&e.HiddenByUser&&(this.oskButtonNode.className="kmw_button")},this.showKeyboardsPopup=e=>(this.addKeyboardsToMap(),this.toolbarNode.className=="kmw_controls_disabled"?this.eventCapture(e):(this.hideKeyboardsForLanguage(null),this.selectorNode.className=="kmw_over"?this.hideKeyboardsPopup(e):(this.selectorNode.className="kmw_over",this.keyboardsButtonNode.className="kmw_button_selected",this.SetupPopupDismissal(this.selectorNode,this.hideKeyboardsPopup),this.eventCapture(e)))),this.hideKeyboardsPopup=e=>(this.selectorNode.className="",this.keyboardsButtonNode.className="kmw_button",this.CancelPopupDismissal(this.hideKeyboardsPopup),this.eventCapture(e)),this.hideAllPopups=e=>{let t=this.keyboardsForLangPopup;return(!t||t.style.display=="none")&&this.selectorNode.className==""?!0:(this.hideKeyboardsPopup(e),this.hideKeyboardsForLanguage(e),this.eventCapture(e))},this.dismissalCallback=null,this.popupElement=null,this.lastDismissalCallback=null,this.PopupDismissal=e=>{let t=e&&e.target||window.event&&window.event.srcElement;if(t)for(;t.parentElement;){if(t==this.popupElement)return null;t=t.parentElement}return t.nodeName=="#document"&&this.hideAllPopups(e),this.dismissalCallback}}createNode(e,t,s,o){let i=document.createElement(e);return t&&(i.id=t),s&&(i.className=s),o&&(i.innerHTML=o),(e=="a"||e=="area"||e=="map")&&(i.ondragstart=()=>!1),i}initialize(){if(!n.initialized||this.init)return;let e=document.getElementById("KeymanWebControl");if(!e){if(document.body==null)return;e=document.createElement("div"),e.id="KeymanWebControl",document.body.insertBefore(e,document.body.firstChild),this._insertedElem=e}if(e.style.visibility="hidden",e.style.maxHeight="35px",this.init=!0,g.isTouchDevice())return;this.regions={},this.regions.na={t:this.ToolBar_Text.na,m:"0,3,0,37,24,32,35,37,43,47,49,52,65,54,68,57,71,56,73,59,75,60,93,61,93,57,103,49,118,41,126,41,136,23,148,17,156,14,164,5,164,0,57,0,35,5,25,9,5,8,49,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61,82,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89"},this.regions.eu={t:this.ToolBar_Text.eu,m:"145,29,146,19,158,14,171,6,187,2,206,1,217,4,227,11,231,16,231,33,227,34,225,35,225,37,227,39,228,44,228,47,227,48,223,46,218,44,215,43,208,43,203,45,202,48,205,52,201,52,195,49,189,50,187,48,177,48,175,49,166,50,147,33"},this.regions.af={t:this.ToolBar_Text.af,m:"150,58,158,50,166,50,175,49,177,48,187,48,189,50,195,49,201,52,205,52,207,53,221,75,229,75,231,77,231,85,227,92,232,101,237,106,237,112,227,115,222,118,206,125,199,127,193,127,185,111,183,104,180,87,168,89,153,85,143,71,147,60"},this.regions.as={t:this.ToolBar_Text.as,m:"219,1,221,6,228,12,231,16,231,33,227,34,225,35,225,37,227,39,229,45,232,48,239,48,240,49,239,53,242,60,243,65,249,70,252,81,259,87,271,87,278,95,289,100,303,101,311,98,320,98,323,98,323,84,311,81,308,73,307,65,317,57,330,50,334,44,348,36,364,38,375,34,375,8,355,8,336,5,292,1,285,0,219,0"},this.regions.oc={t:this.ToolBar_Text.oc,m:"288,117,289,107,303,101,311,98,323,98,323,84,333,77,344,73,362,80,369,88,375,96,375,141,352,143,323,142,316,136,310,130,291,130"},this.regions.un={t:this.ToolBar_Text.un,m:"205,52,202,48,203,45,208,43,215,43,218,44,223,46,227,48,232,48,239,48,240,49,239,53,242,60,243,65,237,76,231,77,229,75,221,75,207,53"},this.toolbarNode=this.createNode("div","kmw_controls"),this.toolbarNode.style.display="block",g.linkStyleSheet(g.getOption("resources")+"ui/toolbar/kmwuitoolbar.css");let t=this.createNode("a","kmw_controls_start",null," ");t.href="https://keyman.com/developer/keymanweb/",t.target="_blank",this.toolbarNode.appendChild(t),this.keyboardsButtonNode=this.createNode("div","kmw_btn_keyboards","kmw_button"),this.keyboardsButtonNode.title=this.ToolBar_Text.LanguageSelector;let s=this.createNode("a",null,"kmw_button_a");s.href="#",s.onclick=this.showKeyboardsPopup,s.appendChild(this.createNode("div","kmw_img_keyboards","kmw_img")),s.appendChild(this.createNode("div",null,"kmw_a",this.ToolBar_Text.Keyboards)),s.appendChild(this.createNode("div",null,"kmw_drop")),this.keyboardsButtonNode.appendChild(s),this.selectorNode=this.createNode("div","kmw_selector"),this.regionsNode=this.createNode("div","kmw_selector_regions"),this.browseMapNode=this.createNode("div","kmw_browsemap");let o=this.createNode("img","kmw_region_browsemap");o.src=g.getOption("resources")+"ui/toolbar/blank.gif",o.useMap="#kmw_worldgrey16",this.browseMapNode.appendChild(o);let i=this.createNode("map","kmw_worldgrey16");i.name="kmw_worldgrey16";for(let r in this.regions){let u=this.createNode("area");u.shape="poly",u.alt="",u.href="#",u.title=this.regions[r].t,u.hidefocus="true",u.onclick=(h=>d=>this.selectRegion(d,h))(r),u.onmouseover=(h=>d=>this.hoverRegion(d,h))(r),u.onmouseout=(h=>d=>this.unhoverRegion(d,h))(r),u.coords=this.regions[r].m,i.appendChild(u)}let a=this.createNode("area");a.shape="default",a.noHref=!0,a.alt="",a.onclick=this.eventCapture,i.appendChild(a),this.browseMapNode.appendChild(i),this.regionsNode.appendChild(this.browseMapNode),this.regionNodes={};let l=this.createNode("ul");for(let r in this.regions){let u=this.createNode("li");this.regionNodes[r]=this.createNode("a",null,null,this.regions[r].t),this.regionNodes[r].href="#",this.regionNodes[r].onclick=(h=>d=>this.selectRegion(d,h))(r),this.regionNodes[r].onmouseover=(h=>d=>this.hoverRegion(d,h))(r),this.regionNodes[r].onmouseout=(h=>d=>this.unhoverRegion(d,h))(r),u.appendChild(this.regionNodes[r]),l.appendChild(u)}this.regionsNode.appendChild(l),this.selectorNode.appendChild(this.regionsNode),this.keyboardsButtonNode.appendChild(this.selectorNode),this.toolbarNode.appendChild(this.keyboardsButtonNode),this.toolbarNode.appendChild(this.offBarNode=this.createNode("div","kmw_bar_off","kmw_bar")),this.offButtonNode=this.createNode("div","kmw_btn_off","kmw_button_selected"),s=this.createNode("a",null,"kmw_button_a"),s.href="#",s.onclick=this.offButtonClickEvent,s.title=this.ToolBar_Text.OffTitle,s.appendChild(this.createNode("div","kmw_img_off","kmw_img")),s.appendChild(this.createNode("div",null,"kmw_a",this.ToolBar_Text.Off)),this.offButtonNode.appendChild(s),this.toolbarNode.appendChild(this.offButtonNode),this.toolbarNode.appendChild(this.languageButtonsNode=this.createNode("div","kmw_control_keyboards","kmw_button")),this.toolbarNode.appendChild(this.oskBarNode=this.createNode("div","kmw_bar_osk","kmw_bar")),this.oskButtonNode=this.createNode("div","kmw_btn_osk","kmw_button"),s=this.createNode("a",null,"kmw_button_a"),s.href="#",s.onclick=this.showOSK,s.onmousedown=function(){n.activatingUI(!0)},s.title=this.ToolBar_Text.ShowOSK,s.appendChild(this.createNode("div","kmw_img_osk","kmw_img")),this.oskButtonNode.appendChild(s),this.toolbarNode.appendChild(this.oskButtonNode),this.toolbarNode.appendChild(this.createNode("div","kmw_controls_end",null," "));let b=this.createNode("div");b.id="kmw_map_preload",this.toolbarNode.appendChild(b),this.toolbarNode.appendChild(this.createNode("br",null,"kmw_clear")),e.appendChild(this.toolbarNode),this.updateMap=!0,this.startTimer&&clearTimeout(this.startTimer),this.startTimer=window.setTimeout(this.addKeyboardsToMap,0),g.attachDOMEvent(document.body,"click",this.hideAllPopups,!1),this.selectedRegion="eu",this.registerEvents(),n.focusLastActiveElement()}shutdown(){let e=this.toolbarNode;e&&e.parentNode.removeChild(e),e=this._insertedElem,e&&e.parentNode.removeChild(e)}findListedKeyboard(e){typeof e!="string"&&(e=e.id);for(let t=0;t<this.listedKeyboards.length;t++)if(this.listedKeyboards[t].lang.id==e)return t;return null}addKeyboardToList(e,t){let s=this.findListedKeyboard(e);if(s==null){if(this.listedKeyboards.length>=this.maxListedKeyboards){let h=2147483647,d=null;for(let c=0;c<this.listedKeyboards.length;c++)this.listedKeyboards[c].priority<h&&(d=c,h=this.listedKeyboards[c].priority);if(d!=null){let c=this.listedKeyboards[d];this.langKeyboardListNodes[c.lang.id]=null,this.langKeyboardNodes[c.lang.id]=null,this.languageButtonsNode.removeChild(c.buttonNode),d==0?this.listedKeyboards=this.listedKeyboards.slice(d+1):d==this.listedKeyboards.length-1?this.listedKeyboards=this.listedKeyboards.slice(0,d):this.listedKeyboards=this.listedKeyboards.slice(0,d).concat(this.listedKeyboards.slice(d+1))}}let o=this.createNode("div",null,"kmw_button"),i=this.createNode("a",null,"kmw_button_a"+(e.keyboards.length>1?" kmw_norightgap":""));i.href="#";let a=this.ToolBar_Text.SelectKeyboardPre+t.Name,l=this.ToolBar_Text.SelectKeyboardSuf;a.toLowerCase().indexOf(l.toLowerCase())<0&&(a=a+" "+l),i.title=a,i.onclick=h=>this.selectLanguage(h,e),i.appendChild(this.createNode("div","kmw_img_kbd","kmw_img")),this.lgText=this.truncate(e.name,28),i.appendChild(this.createNode("div",null,"kmw_a",this.lgText)),o.appendChild(i);let b=i;if(e.keyboards.length>1){i=this.createNode("a",null,"kmw_button_a kmw_noleftgap"),i.href="#",i.title=this.ToolBar_Text.AltKeyboardsPre+e.name+this.ToolBar_Text.AltKeyboardsSuf,i.onclick=c=>this.showKeyboardsForLanguage(c,e);let h=this.createNode("div",null,"kmw_a"),d=this.truncate(t.Name.replace(/\s?keyboard/i,""),40-this.lgText.length);h.appendChild(this.langKeyboardNodes[e.id]=this.createNode("span",null,"kmw_kbd",d)),i.appendChild(h),i.appendChild(this.createNode("div",null,"kmw_drop")),o.appendChild(i),this.langKeyboardListNodes[e.id]=this.createNode("ul",null,"kmw_selector_kbd"),this.langKeyboardListNodes[e.id].style.display="none";for(let c in e.keyboards){let m=this.createNode("li");d=e.keyboards[c].Name.replace(/\s?keyboard/i,""),d=d+" ["+e.keyboards[c].LanguageCode+"]",i=this.createNode("a",null,null,d),i.href="#",i.title="",i.onclick=((_,K)=>w=>this.selectKeyboard(w,_,K,!0))(e,e.keyboards[c]),m.appendChild(i),this.langKeyboardListNodes[e.id].appendChild(m)}o.appendChild(this.langKeyboardListNodes[e.id])}this.languageButtonsNode.appendChild(o);let r=e,u=o;this.listedKeyboards.push({priority:this.keyboardListPriority++,lang:r,keyboard:t,buttonNode:u,aNode:b})}else{this.listedKeyboards[s].priority=this.keyboardListPriority++,this.listedKeyboards[s].keyboard=t;let o=this.langKeyboardNodes[e.id];if(o){let i=t.Name.replace(/\s?keyboard/i,"");o.innerHTML=this.truncate(i,40-this.lgText.length)}if(this.listedKeyboards[s].aNode){let i=this.ToolBar_Text.SelectKeyboardPre+t.Name,a=this.ToolBar_Text.SelectKeyboardSuf;i.toLowerCase().indexOf(a.toLowerCase())<0&&(i=i+" "+a),this.listedKeyboards[s].aNode.title=i}}}truncate(e,t){return e.length<=t?e:e.substr(0,t-1)+"\u2026"}selectLanguage(e,t){let s=this.findListedKeyboard(t),o=null;return s==null?o=t.keyboards[0]:o=this.listedKeyboards[s].keyboard,o?this.selectKeyboard(e,t,o,!0):!1}selectKeyboard(e,t,s,o){if(n.activatingUI(!0),this.selectedLanguage){let i=this.findListedKeyboard(this.selectedLanguage);i!=null&&(this.listedKeyboards[i].buttonNode.className="kmw_button")}return this.offButtonNode.className="kmw_button",this.selectedKeyboard=s,this.selectedLanguage=s.LanguageCode,this.addKeyboardToList(t,s),o&&n.setActiveKeyboard(s.InternalName,s.LanguageCode).then(()=>{this.setLastFocus()}),this.listedKeyboards[this.findListedKeyboard(t)].buttonNode.className="kmw_button_selected",this.saveCookie(),this.enableControls(),n.activatingUI(!1),this.hideKeyboardsPopup(e)||this.hideKeyboardsForLanguage(e)}enableControls(){let e=[this.offButtonNode,this.offBarNode,this.oskButtonNode,this.oskBarNode],t=!1;if(n.isCJK(this.selectedKeyboard)?t=!0:this.selectedKeyboard==null&&(t=e[2].style.display=="none"),this.selectedKeyboard!=null||this.listedKeyboards.length>0)for(let s=0;s<e.length;s++)e[s].style.display="";else for(let s=0;s<e.length;s++)e[s].style.display="none";return t?this.oskButtonNode.style.display=this.oskBarNode.style.display="none":this.selectedKeyboard==null&&(this.oskButtonNode.className="kmw_button_disabled"),this.toolbarNode.parentElement.style.visibility="visible",!0}setLastFocus(){n.focusLastActiveElement()}pluck(e,t){return e.getAttribute&&e.getAttribute(t)||e[t]}registerEvents(){let e=n.osk;e&&(e.addEventListener("show",this.onShowOSK),e.addEventListener("hide",this.onHideOSK))}SetupPopupDismissal(e,t){this.PopupDismissal==document.onclick&&this.CancelPopupDismissal(this.dismissalCallback),this.dismissalCallback=t,this.popupElement=e,this.lastDismissalCallback=document.onclick,document.onclick=this.PopupDismissal}CancelPopupDismissal(e){this.PopupDismissal==document.onclick&&(document.onclick=this.lastDismissalCallback,this.lastDismissalCallback=null,this.dismissalCallback=null,this.popupElement=null)}loadCookie(){let e="",t=g.loadCookie("KeymanWeb_Keyboard");t.current!=null&&(e=t.current.split(":")[0]);let s=g.loadCookie("KeymanWeb_Toolbar");if(s.region!=null&&(this.selectedRegion=s.region),s.maxrecent!=null){for(let o=0;o<s.maxrecent;o++)if(s[`recent${o}`]!=null){let i=s[`recent${o}`].split(",");if(i.length==2){let a=this.languages[i[0]];if(a!=null){for(let l=0;l<a.keyboards.length;l++)if(a.keyboards[l].InternalName==i[1]){if(this.addKeyboardToList(a,a.keyboards[l]),a.keyboards[l].InternalName==e){this.selectKeyboard(null,a,a.keyboards[l],!0),window.focus(),this.setLastFocus();break}break}}}}}else{let o=n.getActiveKeyboard(),i=n.getActiveLanguage();if(i!=""&&o!=""){let a=this.languages[i];if(a!=null)for(let l=0;l<a.keyboards.length;l++)a.keyboards[l].InternalName==o&&(this.selectKeyboard(null,a,a.keyboards[l],!0),window.focus(),this.setLastFocus())}}}saveCookie(){let e={region:this.selectedRegion,maxrecent:this.listedKeyboards.length};e.region=this.selectedRegion,e.maxrecent=this.listedKeyboards.length;for(let t=0;t<this.listedKeyboards.length;t++)e[`recent${t}`]=this.listedKeyboards[t].lang.id+","+this.listedKeyboards[t].keyboard.InternalName;g.saveCookie("KeymanWeb_Toolbar",e)}};k(N,"ToolbarUI");let p=N,f=n.ui=new p;n.addEventListener("keyboardregistered",f.registerKeyboard),n.addEventListener("controlfocused",f.focusControlEvent),n.addEventListener("controlblurred",f.blurControlEvent),n.addEventListener("keyboardchange",f.changeKeyboardEvent),f.initialize()}catch(g){}}else throw new Error("`keyman` global is missing; Keyman Engine for Web script has not been loaded");})();
//# sourceMappingURL=kmwuitoolbar.js.map
