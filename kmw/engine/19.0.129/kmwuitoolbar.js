(()=>{var L=Object.defineProperty;var g=(p,m)=>L(p,"name",{value:m,configurable:!0});function _(p,m,b,y){function k(e){return e instanceof b?e:new b(function(t){t(e)})}return g(k,"adopt"),new(b||(b=Promise))(function(e,t){function o(n){try{i(y.next(n))}catch(r){t(r)}}g(o,"fulfilled");function s(n){try{i(y.throw(n))}catch(r){t(r)}}g(s,"rejected");function i(n){n.done?e(n.value):k(n.value).then(o,s)}g(i,"step"),i((y=y.apply(p,m||[])).next())})}g(_,"__awaiter");var w,l=window.keyman;if(l){if(!(!((w=l.ui)===null||w===void 0)&&w.name))try{let p=l.util;if(p.isTouchDevice())throw"";let y=class y{constructor(){this.init=!1,this.toolbarNode=null,this.browseMapNode=null,this.keyboardsButtonNode=null,this.languageButtonsNode=null,this.offButtonNode=null,this.offBarNode=null,this.oskButtonNode=null,this.oskBarNode=null,this.selectorNode=null,this.regionLanguageListNodes={},this.regionsNode=null,this.regionNodes=null,this.langKeyboardNodes={},this.langKeyboardListNodes={},this.selectedRegion="as",this.listedKeyboards=[],this.catchAllRegion="un",this.keyboardListPriority=0,this.maxListedKeyboards=1,this.lastActiveControl=null,this.selectedKeyboard=null,this.selectedLanguage="",this.helpOffsetX=0,this.helpOffsetY=0,this.keyboardsForLangPopup=null,this.lastSelectedKeyboard=null,this.languages={},this.updateMap=!1,this.startTimer=0,this.lgText="",this.name="toolbar",this.ToolBar_Text={Keyboards:"Languages",OffTitle:"Turn off KeymanWeb keyboards",Off:"Off",ShowOSK:"Show On Screen Keyboard",LanguageSelector:"Select language",SelectKeyboardPre:"Select ",SelectKeyboardSuf:"keyboard",AltKeyboardsPre:"Alternate keyboards for ",AltKeyboardsSuf:"",ca:"Central America",sa:"South America",na:"Americas",eu:"Europe",af:"Africa",un:"Undetermined",as:"Asia",oc:"Oceania"},this.addKeyboardsToMap=()=>{if(this.updateMap)this.updateMap=!1;else return;this.regionLanguageListNodes={};let e=l.getKeyboards();e.sort(this.sortKeyboards);let t=0;for(t=this.regionsNode.children.length;t>0;t--)this.regionsNode.children[t-1].className=="kmw_selector_region"&&this.regionsNode.removeChild(this.regionsNode.childNodes[t-1]);for(let o in this.regions){this.regionLanguageListNodes[o]=this.createNode("div",null,"kmw_selector_region");let s=this.createNode("div",null,"kmw_keyboard_col"),i=0,n=0,r="";for(let f=0;f<e.length;f++){let d=e[f].RegionCode;if(this.regions[d]){if(d!=o)continue}else if(o!=this.catchAllRegion)continue;let u=l.util.getLanguageCodes(e[f].LanguageCode);u[0]!=r&&(r=u[0],i++)}i=Number(((i+3)/4).toFixed(0)),r="";for(let f=0;f<e.length;f++){let d=e[f].RegionCode;if(this.regions[d]){if(d!=o)continue}else if(o!=this.catchAllRegion)continue;let u=l.util.getLanguageCodes(e[f].LanguageCode);if(u[0]==r){let c=this.languages[r].keyboards;c.push?c.push(e[f]):this.languages[r].keyboards=c.concat(e[f]);continue}r=u[0],this.languages[r]={id:e[f].LanguageCode,name:e[f].LanguageName,keyboards:[e[f]]},n%i==0&&n>0&&(this.regionLanguageListNodes[o].appendChild(s),s=this.createNode("div",null,n/i==3?"kmw_keyboard_col_right":"kmw_keyboard_col")),n++;let h=this.createNode("div",null,"kmw_language"),a=this.createNode("a",null,null,e[f].LanguageName);a.href="#",a.onclick=(c=>N=>this.selectLanguage(N,c))(this.languages[r]),h.appendChild(a),s.appendChild(h),t++}this.regionLanguageListNodes[o].appendChild(s),this.regionLanguageListNodes[o].appendChild(this.createNode("div",null,"kmw_clear")),this.regionsNode.appendChild(this.regionLanguageListNodes[o])}this.loadCookie(),this.selectRegion(null,this.selectedRegion),this.enableControls(),this.lastSelectedKeyboard&&this.changeKeyboardEvent(this.lastSelectedKeyboard),l.focusLastActiveElement()},this.sortKeyboards=function(e,t){return e.RegionCode<t.RegionCode?-2:e.RegionCode>t.RegionCode?2:e.LanguageName<t.LanguageName?-1:e.LanguageName>t.LanguageName?1:0},this.registerKeyboard=()=>{this.updateMap=!0,this.startTimer&&clearTimeout(this.startTimer),this.startTimer=window.setTimeout(this.addKeyboardsToMap,0)},this.hideKeyboardsForLanguage=e=>{let t=this.keyboardsForLangPopup;return t&&(t.style.display="none"),this.CancelPopupDismissal(this.hideKeyboardsForLanguage),this.eventCapture(e)},this.showKeyboardsForLanguage=(e,t)=>{this.hideKeyboardsPopup(e);let o=this.langKeyboardListNodes[t.id];if(o){if(o.style.display=="block")return this.hideKeyboardsForLanguage(e);o.style.display="block",this.keyboardsForLangPopup=o,this.SetupPopupDismissal(o,this.hideKeyboardsForLanguage)}return this.eventCapture(e)},this.showOSK=e=>{let t=l.osk;return t?(l.activatingUI(!0),t&&l.getActiveKeyboard()!=""&&(t.isEnabled()?t.hide():t.show(!0)),this.setLastFocus(),l.activatingUI(!1),this.eventCapture(e)):!1},this.offButtonClickEvent=e=>_(this,void 0,void 0,function*(){if(this.toolbarNode.className!="kmw_controls_disabled"){if(this.hideKeyboardsForLanguage(null),this.selectedLanguage){let t=this.findListedKeyboard(this.selectedLanguage);t!=null&&(this.listedKeyboards[t].buttonNode.className="kmw_button")}this.selectedKeyboard=null,this.selectedLanguage=null,this.offButtonNode.className="kmw_button_selected"}return this.setLastFocus(),yield l.setActiveKeyboard("",""),this.saveCookie(),this.enableControls(),this.eventCapture(e)}),this.eventCapture=e=>(e||(e=window.event),window.event&&(window.event.returnValue=!1),e&&(e.cancelBubble=!0),!1),this.selectRegion=(e,t)=>{let o=this.browseMapNode;return o?(o.className="kmw_browsemap_"+t,typeof this.regionLanguageListNodes[t]=="undefined"&&(this.updateMap=!0,this.addKeyboardsToMap()),this.regionLanguageListNodes[t].style.display="block",this.regionNodes[t].className="selected",this.selectedRegion!=null&&this.selectedRegion!=t&&(this.regionLanguageListNodes[this.selectedRegion].style.display="none",this.regionNodes[this.selectedRegion].className=""),this.selectedRegion=t,this.eventCapture(e)):this.eventCapture(e)},this.unhoverRegion=(e,t)=>(this.browseMapNode.className=this.selectedRegion==null?"":"kmw_browsemap_"+this.selectedRegion,this.regionNodes[t].className=this.selectedRegion==t?"selected":"",this.eventCapture(e)),this.hoverRegion=(e,t)=>(this.browseMapNode.className="kmw_browsemap_"+t+"_sel",this.regionNodes[t].className="hover",this.eventCapture(e)),this.focusControlEvent=e=>{if(!this.init)return!0;let t=e.target;if(t.tagName.toLowerCase()=="textarea"||t.tagName.toLowerCase()=="input"&&t.type.toLowerCase()=="text")if(this.lastActiveControl=t,this.pluck(t,"kmw_disable"))this.toolbarNode.className!="kmw_controls_disabled"&&(this.toolbarNode.className="kmw_controls_disabled");else{if(this.selectedKeyboard!=null)if(l.isCJK())this.oskButtonNode.style.display=this.oskBarNode.style.display="none";else{let i=l.osk;this.oskButtonNode.className=i&&i.isEnabled()?"kmw_button_selected":"kmw_button"}this.toolbarNode.className!=""&&(this.toolbarNode.className="");let o,s;t.KMW_HelpOffsetX?o=t.KMW_HelpOffsetX:o=64,t.KMW_HelpOffsetY?s=t.KMW_HelpOffsetY:s=0,this.helpOffsetX=p.getAbsoluteX(t)+o,this.helpOffsetY=p.getAbsoluteY(t)+t.offsetHeight+s}return!0},this.blurControlEvent=()=>(this.init&&this.oskButtonNode.style.display!="none"&&(this.oskButtonNode.className="kmw_button_disabled"),!0),this.changeKeyboardEvent=e=>{this.lastSelectedKeyboard=null;let t=e.internalName,o=l.util.getLanguageCodes(e.languageCode)[0];if(o!=""&&t!=""){let s=this.languages[o];if(s!=null){for(let i=0;i<s.keyboards.length;i++)if(s.keyboards[i].InternalName==t)return this.selectKeyboard(null,s,s.keyboards[i],!1),!0}this.lastSelectedKeyboard=Object.assign({},e)}return!0},this.onShowOSK=e=>(this.init&&(this.oskButtonNode.className="kmw_button_selected"),e),this.onHideOSK=e=>{this.init&&e.HiddenByUser&&(this.oskButtonNode.className="kmw_button")},this.showKeyboardsPopup=e=>(this.addKeyboardsToMap(),this.toolbarNode.className=="kmw_controls_disabled"?this.eventCapture(e):(this.hideKeyboardsForLanguage(null),this.selectorNode.className=="kmw_over"?this.hideKeyboardsPopup(e):(this.selectorNode.className="kmw_over",this.keyboardsButtonNode.className="kmw_button_selected",this.SetupPopupDismissal(this.selectorNode,this.hideKeyboardsPopup),this.eventCapture(e)))),this.hideKeyboardsPopup=e=>(this.selectorNode.className="",this.keyboardsButtonNode.className="kmw_button",this.CancelPopupDismissal(this.hideKeyboardsPopup),this.eventCapture(e)),this.hideAllPopups=e=>{let t=this.keyboardsForLangPopup;return(!t||t.style.display=="none")&&this.selectorNode.className==""?!0:(this.hideKeyboardsPopup(e),this.hideKeyboardsForLanguage(e),this.eventCapture(e))},this.dismissalCallback=null,this.popupElement=null,this.lastDismissalCallback=null,this.PopupDismissal=e=>{let t=e&&e.target||window.event&&window.event.srcElement;if(t)for(;t.parentElement;){if(t==this.popupElement)return null;t=t.parentElement}return t.nodeName=="#document"&&this.hideAllPopups(e),this.dismissalCallback}}createNode(e,t,o,s){let i=document.createElement(e);return t&&(i.id=t),o&&(i.className=o),s&&(i.innerHTML=s),(e=="a"||e=="area"||e=="map")&&(i.ondragstart=()=>!1),i}initialize(){if(!l.initialized||this.init)return;let e=document.getElementById("KeymanWebControl");if(!e){if(document.body==null)return;e=document.createElement("div"),e.id="KeymanWebControl",document.body.insertBefore(e,document.body.firstChild),this._insertedElem=e}if(e.style.visibility="hidden",e.style.maxHeight="35px",this.init=!0,p.isTouchDevice())return;this.regions={},this.regions.na={t:this.ToolBar_Text.na,m:"0,3,0,37,24,32,35,37,43,47,49,52,65,54,68,57,71,56,73,59,75,60,93,61,93,57,103,49,118,41,126,41,136,23,148,17,156,14,164,5,164,0,57,0,35,5,25,9,5,8,49,52,65,54,68,57,71,56,73,59,75,60,93,61,94,58,97,58,101,59,107,60,114,64,115,68,114,77,104,74,98,75,96,78,95,82,90,81,85,80,82,76,78,74,74,73,65,68,57,61,82,82,95,82,96,78,98,75,104,74,114,77,120,79,124,83,126,87,141,90,142,97,138,103,135,113,127,116,123,124,115,131,112,132,109,138,117,139,140,141,141,146,134,148,114,145,109,148,100,148,91,143,91,130,96,111,89,102,83,95,77,89"},this.regions.eu={t:this.ToolBar_Text.eu,m:"145,29,146,19,158,14,171,6,187,2,206,1,217,4,227,11,231,16,231,33,227,34,225,35,225,37,227,39,228,44,228,47,227,48,223,46,218,44,215,43,208,43,203,45,202,48,205,52,201,52,195,49,189,50,187,48,177,48,175,49,166,50,147,33"},this.regions.af={t:this.ToolBar_Text.af,m:"150,58,158,50,166,50,175,49,177,48,187,48,189,50,195,49,201,52,205,52,207,53,221,75,229,75,231,77,231,85,227,92,232,101,237,106,237,112,227,115,222,118,206,125,199,127,193,127,185,111,183,104,180,87,168,89,153,85,143,71,147,60"},this.regions.as={t:this.ToolBar_Text.as,m:"219,1,221,6,228,12,231,16,231,33,227,34,225,35,225,37,227,39,229,45,232,48,239,48,240,49,239,53,242,60,243,65,249,70,252,81,259,87,271,87,278,95,289,100,303,101,311,98,320,98,323,98,323,84,311,81,308,73,307,65,317,57,330,50,334,44,348,36,364,38,375,34,375,8,355,8,336,5,292,1,285,0,219,0"},this.regions.oc={t:this.ToolBar_Text.oc,m:"288,117,289,107,303,101,311,98,323,98,323,84,333,77,344,73,362,80,369,88,375,96,375,141,352,143,323,142,316,136,310,130,291,130"},this.regions.un={t:this.ToolBar_Text.un,m:"205,52,202,48,203,45,208,43,215,43,218,44,223,46,227,48,232,48,239,48,240,49,239,53,242,60,243,65,237,76,231,77,229,75,221,75,207,53"},this.toolbarNode=this.createNode("div","kmw_controls"),this.toolbarNode.style.display="block",p.linkStyleSheet(p.getOption("resources")+"ui/toolbar/kmwuitoolbar.css");let t=this.createNode("a","kmw_controls_start",null," ");t.href="https://keyman.com/developer/keymanweb/",t.target="_blank",this.toolbarNode.appendChild(t),this.keyboardsButtonNode=this.createNode("div","kmw_btn_keyboards","kmw_button"),this.keyboardsButtonNode.title=this.ToolBar_Text.LanguageSelector;let o=this.createNode("a",null,"kmw_button_a");o.href="#",o.onclick=this.showKeyboardsPopup,o.appendChild(this.createNode("div","kmw_img_keyboards","kmw_img")),o.appendChild(this.createNode("div",null,"kmw_a",this.ToolBar_Text.Keyboards)),o.appendChild(this.createNode("div",null,"kmw_drop")),this.keyboardsButtonNode.appendChild(o),this.selectorNode=this.createNode("div","kmw_selector"),this.regionsNode=this.createNode("div","kmw_selector_regions"),this.browseMapNode=this.createNode("div","kmw_browsemap");let s=this.createNode("img","kmw_region_browsemap");s.src=p.getOption("resources")+"ui/toolbar/blank.gif",s.useMap="#kmw_worldgrey16",this.browseMapNode.appendChild(s);let i=this.createNode("map","kmw_worldgrey16");i.name="kmw_worldgrey16";for(let d in this.regions){let u=this.createNode("area");u.shape="poly",u.alt="",u.href="#",u.title=this.regions[d].t,u.hidefocus="true",u.onclick=(h=>a=>this.selectRegion(a,h))(d),u.onmouseover=(h=>a=>this.hoverRegion(a,h))(d),u.onmouseout=(h=>a=>this.unhoverRegion(a,h))(d),u.coords=this.regions[d].m,i.appendChild(u)}let n=this.createNode("area");n.shape="default",n.noHref=!0,n.alt="",n.onclick=this.eventCapture,i.appendChild(n),this.browseMapNode.appendChild(i),this.regionsNode.appendChild(this.browseMapNode),this.regionNodes={};let r=this.createNode("ul");for(let d in this.regions){let u=this.createNode("li");this.regionNodes[d]=this.createNode("a",null,null,this.regions[d].t),this.regionNodes[d].href="#",this.regionNodes[d].onclick=(h=>a=>this.selectRegion(a,h))(d),this.regionNodes[d].onmouseover=(h=>a=>this.hoverRegion(a,h))(d),this.regionNodes[d].onmouseout=(h=>a=>this.unhoverRegion(a,h))(d),u.appendChild(this.regionNodes[d]),r.appendChild(u)}this.regionsNode.appendChild(r),this.selectorNode.appendChild(this.regionsNode),this.keyboardsButtonNode.appendChild(this.selectorNode),this.toolbarNode.appendChild(this.keyboardsButtonNode),this.toolbarNode.appendChild(this.offBarNode=this.createNode("div","kmw_bar_off","kmw_bar")),this.offButtonNode=this.createNode("div","kmw_btn_off","kmw_button_selected"),o=this.createNode("a",null,"kmw_button_a"),o.href="#",o.onclick=this.offButtonClickEvent,o.title=this.ToolBar_Text.OffTitle,o.appendChild(this.createNode("div","kmw_img_off","kmw_img")),o.appendChild(this.createNode("div",null,"kmw_a",this.ToolBar_Text.Off)),this.offButtonNode.appendChild(o),this.toolbarNode.appendChild(this.offButtonNode),this.toolbarNode.appendChild(this.languageButtonsNode=this.createNode("div","kmw_control_keyboards","kmw_button")),this.toolbarNode.appendChild(this.oskBarNode=this.createNode("div","kmw_bar_osk","kmw_bar")),this.oskButtonNode=this.createNode("div","kmw_btn_osk","kmw_button"),o=this.createNode("a",null,"kmw_button_a"),o.href="#",o.onclick=this.showOSK,o.onmousedown=function(){l.activatingUI(!0)},o.title=this.ToolBar_Text.ShowOSK,o.appendChild(this.createNode("div","kmw_img_osk","kmw_img")),this.oskButtonNode.appendChild(o),this.toolbarNode.appendChild(this.oskButtonNode),this.toolbarNode.appendChild(this.createNode("div","kmw_controls_end",null," "));let f=this.createNode("div");f.id="kmw_map_preload",this.toolbarNode.appendChild(f),this.toolbarNode.appendChild(this.createNode("br",null,"kmw_clear")),e.appendChild(this.toolbarNode),this.updateMap=!0,this.startTimer&&clearTimeout(this.startTimer),this.startTimer=window.setTimeout(this.addKeyboardsToMap,0),p.attachDOMEvent(document.body,"click",this.hideAllPopups,!1),this.selectedRegion="eu",this.registerEvents(),l.focusLastActiveElement()}shutdown(){let e=this.toolbarNode;e&&e.parentNode.removeChild(e),e=this._insertedElem,e&&e.parentNode.removeChild(e)}findListedKeyboard(e){typeof e!="string"&&(e=e.id);for(let t=0;t<this.listedKeyboards.length;t++)if(this.listedKeyboards[t].lang.id==e)return t;return null}addKeyboardToList(e,t){let o=this.findListedKeyboard(e);if(o==null){if(this.listedKeyboards.length>=this.maxListedKeyboards){let h=2147483647,a=null;for(let c=0;c<this.listedKeyboards.length;c++)this.listedKeyboards[c].priority<h&&(a=c,h=this.listedKeyboards[c].priority);if(a!=null){let c=this.listedKeyboards[a];this.langKeyboardListNodes[c.lang.id]=null,this.langKeyboardNodes[c.lang.id]=null,this.languageButtonsNode.removeChild(c.buttonNode),a==0?this.listedKeyboards=this.listedKeyboards.slice(a+1):a==this.listedKeyboards.length-1?this.listedKeyboards=this.listedKeyboards.slice(0,a):this.listedKeyboards=this.listedKeyboards.slice(0,a).concat(this.listedKeyboards.slice(a+1))}}let s=this.createNode("div",null,"kmw_button"),i=this.createNode("a",null,"kmw_button_a"+(e.keyboards.length>1?" kmw_norightgap":""));i.href="#";let n=this.ToolBar_Text.SelectKeyboardPre+t.Name,r=this.ToolBar_Text.SelectKeyboardSuf;n.toLowerCase().indexOf(r.toLowerCase())<0&&(n=n+" "+r),i.title=n,i.onclick=h=>this.selectLanguage(h,e),i.appendChild(this.createNode("div","kmw_img_kbd","kmw_img")),this.lgText=this.truncate(e.name,28),i.appendChild(this.createNode("div",null,"kmw_a",this.lgText)),s.appendChild(i);let f=i;if(e.keyboards.length>1){i=this.createNode("a",null,"kmw_button_a kmw_noleftgap"),i.href="#",i.title=this.ToolBar_Text.AltKeyboardsPre+e.name+this.ToolBar_Text.AltKeyboardsSuf,i.onclick=c=>this.showKeyboardsForLanguage(c,e);let h=this.createNode("div",null,"kmw_a"),a=this.truncate(t.Name.replace(/\s?keyboard/i,""),40-this.lgText.length);h.appendChild(this.langKeyboardNodes[e.id]=this.createNode("span",null,"kmw_kbd",a)),i.appendChild(h),i.appendChild(this.createNode("div",null,"kmw_drop")),s.appendChild(i),this.langKeyboardListNodes[e.id]=this.createNode("ul",null,"kmw_selector_kbd"),this.langKeyboardListNodes[e.id].style.display="none";for(let c in e.keyboards){let N=this.createNode("li");a=e.keyboards[c].Name.replace(/\s?keyboard/i,""),a=a+" ["+e.keyboards[c].LanguageCode+"]",i=this.createNode("a",null,null,a),i.href="#",i.title="",i.onclick=((v,K)=>C=>this.selectKeyboard(C,v,K,!0))(e,e.keyboards[c]),N.appendChild(i),this.langKeyboardListNodes[e.id].appendChild(N)}s.appendChild(this.langKeyboardListNodes[e.id])}this.languageButtonsNode.appendChild(s);let d=e,u=s;this.listedKeyboards.push({priority:this.keyboardListPriority++,lang:d,keyboard:t,buttonNode:u,aNode:f})}else{this.listedKeyboards[o].priority=this.keyboardListPriority++,this.listedKeyboards[o].keyboard=t;let s=this.langKeyboardNodes[e.id];if(s){let i=t.Name.replace(/\s?keyboard/i,"");s.innerHTML=this.truncate(i,40-this.lgText.length)}if(this.listedKeyboards[o].aNode){let i=this.ToolBar_Text.SelectKeyboardPre+t.Name,n=this.ToolBar_Text.SelectKeyboardSuf;i.toLowerCase().indexOf(n.toLowerCase())<0&&(i=i+" "+n),this.listedKeyboards[o].aNode.title=i}}}truncate(e,t){return e.length<=t?e:e.substr(0,t-1)+"\u2026"}selectLanguage(e,t){let o=this.findListedKeyboard(t),s=null;return o==null?s=t.keyboards[0]:s=this.listedKeyboards[o].keyboard,s?this.selectKeyboard(e,t,s,!0):!1}selectKeyboard(e,t,o,s){return _(this,void 0,void 0,function*(){if(l.activatingUI(!0),this.selectedLanguage){let i=this.findListedKeyboard(this.selectedLanguage);i!=null&&(this.listedKeyboards[i].buttonNode.className="kmw_button")}return this.offButtonNode.className="kmw_button",this.selectedKeyboard=o,this.selectedLanguage=o.LanguageCode,this.addKeyboardToList(t,o),s&&(yield l.setActiveKeyboard(o.InternalName,o.LanguageCode).then(()=>{this.setLastFocus()})),this.listedKeyboards[this.findListedKeyboard(t)].buttonNode.className="kmw_button_selected",this.saveCookie(),this.enableControls(),l.activatingUI(!1),this.hideKeyboardsPopup(e)||this.hideKeyboardsForLanguage(e)})}enableControls(){let e=[this.offButtonNode,this.offBarNode,this.oskButtonNode,this.oskBarNode],t=!1;if(l.isCJK(this.selectedKeyboard)?t=!0:this.selectedKeyboard==null&&(t=e[2].style.display=="none"),this.selectedKeyboard!=null||this.listedKeyboards.length>0)for(let o=0;o<e.length;o++)e[o].style.display="";else for(let o=0;o<e.length;o++)e[o].style.display="none";return t?this.oskButtonNode.style.display=this.oskBarNode.style.display="none":this.selectedKeyboard==null&&(this.oskButtonNode.className="kmw_button_disabled"),this.toolbarNode.parentElement.style.visibility="visible",!0}setLastFocus(){l.focusLastActiveElement()}pluck(e,t){return e.getAttribute&&e.getAttribute(t)||e[t]}registerEvents(){let e=l.osk;e&&(e.addEventListener("show",this.onShowOSK),e.addEventListener("hide",this.onHideOSK))}SetupPopupDismissal(e,t){this.PopupDismissal==document.onclick&&this.CancelPopupDismissal(this.dismissalCallback),this.dismissalCallback=t,this.popupElement=e,this.lastDismissalCallback=document.onclick,document.onclick=this.PopupDismissal}CancelPopupDismissal(e){this.PopupDismissal==document.onclick&&(document.onclick=this.lastDismissalCallback,this.lastDismissalCallback=null,this.dismissalCallback=null,this.popupElement=null)}loadCookie(){let e="",t=p.loadCookie("KeymanWeb_Keyboard");t.current!=null&&(e=t.current.split(":")[0]);let o=p.loadCookie("KeymanWeb_Toolbar");if(o.region!=null&&(this.selectedRegion=o.region),o.maxrecent!=null){for(let s=0;s<o.maxrecent;s++)if(o[`recent${s}`]!=null){let i=o[`recent${s}`].split(",");if(i.length==2){let n=this.languages[i[0]];if(n!=null){for(let r=0;r<n.keyboards.length;r++)if(n.keyboards[r].InternalName==i[1]){if(this.addKeyboardToList(n,n.keyboards[r]),n.keyboards[r].InternalName==e){this.selectKeyboard(null,n,n.keyboards[r],!0),window.focus(),this.setLastFocus();break}break}}}}}else{let s=l.getActiveKeyboard(),i=l.getActiveLanguage();if(i!=""&&s!=""){let n=this.languages[i];if(n!=null)for(let r=0;r<n.keyboards.length;r++)n.keyboards[r].InternalName==s&&(this.selectKeyboard(null,n,n.keyboards[r],!0),window.focus(),this.setLastFocus())}}}saveCookie(){let e={region:this.selectedRegion,maxrecent:this.listedKeyboards.length};e.region=this.selectedRegion,e.maxrecent=this.listedKeyboards.length;for(let t=0;t<this.listedKeyboards.length;t++)e[`recent${t}`]=this.listedKeyboards[t].lang.id+","+this.listedKeyboards[t].keyboard.InternalName;p.saveCookie("KeymanWeb_Toolbar",e)}};g(y,"ToolbarUI");let m=y,b=l.ui=new m;l.addEventListener("keyboardregistered",b.registerKeyboard),l.addEventListener("controlfocused",b.focusControlEvent),l.addEventListener("controlblurred",b.blurControlEvent),l.addEventListener("keyboardchange",b.changeKeyboardEvent),b.initialize()}catch(p){}}else throw new Error("`keyman` global is missing; Keyman Engine for Web script has not been loaded");})();
//# sourceMappingURL=kmwuitoolbar.js.map
